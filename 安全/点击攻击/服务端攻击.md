# 服务端攻击
<https://mp.weixin.qq.com/s/oYVHuEx6rq7E2i9HX-_zBA>
1. SQL 注入攻击
2. CRLF 注入
3. 文件上传漏洞
4. 登录认证攻击
5. 应用层拒绝服务攻击 DDOS
6. webServer 配置安全


## SQL 注入攻击
SQL 注入和 XSS 一样，都是违背了数据和代码分离原则导致的攻击方式

```sql
select * from user where username = 'admin' or 1=1 and password = 'xxx'
```


## CRLF 注入

换行符注入攻击

如果在 HTTP 请求头中注入 2 个换行符，会导致换行符后面的所有内容都被解析成请求实体部分。
攻击者通常在 Set-Cookie 时，注入换行符，控制请求传递的内容。





## 文件上传漏洞

攻击者上传了一个木马文件，并且通过返回的 URL 进行访问，就能控制服务器

#### 防御

1. 将文件上传的目录设置为不可执行。
2. 判断文件类型，检查 MIME Type，配置白名单。检查后缀名，配置白名单。
3. 使用随机数改写文件名和文件路径，上传文件后，随机修改文件名，让攻击者无法执行攻击。
4. 单独设置文件服务器的域名，通常做法是将静态资源存放在 CDN 上。





## 登录认证攻击

1. 彩虹表
    * 攻击者通过搜集大量明文和 MD5 的对应关系，用于破解 MD5 密文找出原文
    * 对于彩虹表中的 MD5 密码，我们可以加盐，进行二次加密，避免被破解

2. Session 攻击
    * 利用应用系统在服务器的 SessionID 固定不变机制，借助他人用相同的 SessionID 获取认证和授权

#### 防御 
1. 密码作为第一道防御，但在密码验证成功后，我们还可以继续验证：动态口令，数字证书，短信验证码等，以保证用户安全。
2. 由于短信和网页完全是两套独立的系统，攻击者很难获取到短信验证码，也就无法进行攻击。





## 应用层拒绝服务攻击 DDOS 攻击

利用 HTTP 3 次握手机制，消耗服务器连接资源。
如：攻击者发起大量的 HTTP 请求，但并不完成 3 次握手，而是只握手 2 次，这时服务器端会继续等待直至超时。这时的服务器会一直忙于处理大量的垃圾请求，而无暇顾及正常请求。

1. 限制请求频率
    * 服务器计算所有 IP 地址的请求频率，筛选出异常的 IP 进行禁用。
    * 可以使用 LRU 算法，缓存前 1000 条请求的 IP，如果有 IP 请求频率过高，就进行禁用。
2. 合理使用 Redis、Memcache 等缓存方案，减少 CPU 资源使用率





## WebServer 配置安全

1. 遵守最小权限原则，以最小权限身份运行 Web 服务器，限制被入侵后的权限
2. 删除可视化后台，攻击者可以利用可视化后台，远程加载一段 war 包或者上传木马文件，进行控制。
3. 及时更新版本